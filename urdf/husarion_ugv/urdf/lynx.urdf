<?xml version="1.0" ?>
<!-- =================================================================================== -->
<!-- |    This document was autogenerated by xacro from /home/deli/husarion_ws/src/husarion_ugv_ros/husarion_ugv_description/urdf/lynx.urdf.xacro | -->
<!-- |    EDITING THIS FILE BY HAND IS NOT RECOMMENDED                                 | -->
<!-- =================================================================================== -->
<robot name="lynx">
  <joint name="base_to_body_joint" type="fixed">
    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
    <parent link="base_link"/>
    <child link="body_link"/>
  </joint>
  <link name="base_link"/>
  <link name="body_link">
    <visual>
      <geometry>
        <mesh filename="/ros2_ws/src/husarion_ugv_ros/husarion_ugv_description//meshes/lynx/base.dae"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
      <geometry>
        <mesh filename="/ros2_ws/src/husarion_ugv_ros/husarion_ugv_description//meshes/lynx/base_collision.dae"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="0.0 0.0 0.0" xyz="-0.052 0.001 0.038"/>
      <mass value="30.656"/>
      <inertia ixx="0.6572" ixy="0.0334" ixz="0.1739" iyy="1.443" iyz="0.0082" izz="1.598"/>
    </inertial>
  </link>
  <joint name="body_to_footprint_joint" type="fixed">
    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 -0.1348"/>
    <parent link="body_link"/>
    <child link="base_footprint"/>
  </joint>
  <link name="base_footprint"/>
  <joint name="body_to_imu_joint" type="fixed">
    <origin rpy="0.0 0.0 -1.57" xyz="0.052 0.073 -0.006"/>
    <parent link="body_link"/>
    <child link="imu_link"/>
  </joint>
  <link name="imu_link"/>
  <joint name="body_to_cover_joint" type="fixed">
    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.2098"/>
    <parent link="body_link"/>
    <child link="cover_link"/>
  </joint>
  <link name="cover_link"/>
  <joint name="cover_to_mount_joint" type="fixed">
    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0217"/>
    <parent link="cover_link"/>
    <child link="mount_link"/>
  </joint>
  <link name="mount_link"/>
  <joint name="body_to_fl_wheel_base_joint" type="fixed">
    <origin rpy="0.0 0.0 0.0" xyz="0.175 0.1675 0.0"/>
    <parent link="body_link"/>
    <child link="fl_wheel_base_link"/>
  </joint>
  <link name="fl_wheel_base_link"/>
  <joint name="fl_wheel_joint" type="continuous">
    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.06 0.0"/>
    <parent link="fl_wheel_base_link"/>
    <child link="fl_wheel_link"/>
    <axis xyz="0.0 1.0 0.0"/>
    <limit effort="64.5" velocity="10.958"/>
    <dynamics damping="0.01" friction="0.1"/>
  </joint>
  <link name="fl_wheel_link">
    <visual>
      <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
      <geometry>
        <mesh filename="/ros2_ws/src/husarion_ugv_ros/husarion_ugv_description//meshes/WH05/fl_wheel.dae"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="-1.5707963267948966 0.0 0.0" xyz="0.0 0.0 0.0"/>
      <geometry>
        <cylinder length="0.09" radius="0.1348"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
      <mass value="2.036"/>
      <inertia ixx="0.014738" ixy="0.0" ixz="0.0" iyy="0.02593" iyz="0.0" izz="0.014738"/>
    </inertial>
  </link>
  <joint name="body_to_fr_wheel_base_joint" type="fixed">
    <origin rpy="0.0 0.0 0.0" xyz="0.175 -0.1675 0.0"/>
    <parent link="body_link"/>
    <child link="fr_wheel_base_link"/>
  </joint>
  <link name="fr_wheel_base_link"/>
  <joint name="fr_wheel_joint" type="continuous">
    <origin rpy="0.0 0.0 0.0" xyz="0.0 -0.06 0.0"/>
    <parent link="fr_wheel_base_link"/>
    <child link="fr_wheel_link"/>
    <axis xyz="0.0 1.0 0.0"/>
    <limit effort="64.5" velocity="10.958"/>
    <dynamics damping="0.01" friction="0.1"/>
  </joint>
  <link name="fr_wheel_link">
    <visual>
      <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
      <geometry>
        <mesh filename="/ros2_ws/src/husarion_ugv_ros/husarion_ugv_description//meshes/WH05/fr_wheel.dae"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="-1.5707963267948966 0.0 0.0" xyz="0.0 0.0 0.0"/>
      <geometry>
        <cylinder length="0.09" radius="0.1348"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="0.0 0.0 0.0" xyz="0.0 -0.0 0.0"/>
      <mass value="2.036"/>
      <inertia ixx="0.014738" ixy="0.0" ixz="0.0" iyy="0.02593" iyz="0.0" izz="0.014738"/>
    </inertial>
  </link>
  <joint name="body_to_rl_wheel_base_joint" type="fixed">
    <origin rpy="0.0 0.0 0.0" xyz="-0.175 0.1675 0.0"/>
    <parent link="body_link"/>
    <child link="rl_wheel_base_link"/>
  </joint>
  <link name="rl_wheel_base_link"/>
  <joint name="rl_wheel_joint" type="continuous">
    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.06 0.0"/>
    <parent link="rl_wheel_base_link"/>
    <child link="rl_wheel_link"/>
    <axis xyz="0.0 1.0 0.0"/>
    <limit effort="64.5" velocity="10.958"/>
    <dynamics damping="0.01" friction="0.1"/>
  </joint>
  <link name="rl_wheel_link">
    <visual>
      <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
      <geometry>
        <mesh filename="/ros2_ws/src/husarion_ugv_ros/husarion_ugv_description//meshes/WH05/rl_wheel.dae"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="-1.5707963267948966 0.0 0.0" xyz="0.0 0.0 0.0"/>
      <geometry>
        <cylinder length="0.09" radius="0.1348"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
      <mass value="2.036"/>
      <inertia ixx="0.014738" ixy="0.0" ixz="0.0" iyy="0.02593" iyz="0.0" izz="0.014738"/>
    </inertial>
  </link>
  <joint name="body_to_rr_wheel_base_joint" type="fixed">
    <origin rpy="0.0 0.0 0.0" xyz="-0.175 -0.1675 0.0"/>
    <parent link="body_link"/>
    <child link="rr_wheel_base_link"/>
  </joint>
  <link name="rr_wheel_base_link"/>
  <joint name="rr_wheel_joint" type="continuous">
    <origin rpy="0.0 0.0 0.0" xyz="0.0 -0.06 0.0"/>
    <parent link="rr_wheel_base_link"/>
    <child link="rr_wheel_link"/>
    <axis xyz="0.0 1.0 0.0"/>
    <limit effort="64.5" velocity="10.958"/>
    <dynamics damping="0.01" friction="0.1"/>
  </joint>
  <link name="rr_wheel_link">
    <visual>
      <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
      <geometry>
        <mesh filename="/ros2_ws/src/husarion_ugv_ros/husarion_ugv_description//meshes/WH05/rr_wheel.dae"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="-1.5707963267948966 0.0 0.0" xyz="0.0 0.0 0.0"/>
      <geometry>
        <cylinder length="0.09" radius="0.1348"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="0.0 0.0 0.0" xyz="0.0 -0.0 0.0"/>
      <mass value="2.036"/>
      <inertia ixx="0.014738" ixy="0.0" ixz="0.0" iyy="0.02593" iyz="0.0" izz="0.014738"/>
    </inertial>
  </link>
  <ros2_control name="lynx_system" type="system">
    <hardware>
      <plugin>husarion_ugv_hardware_interfaces/LynxSystem</plugin>
      <param name="encoder_resolution">1600</param>
      <param name="gear_ratio">30.08</param>
      <param name="gearbox_efficiency">0.75</param>
      <!-- Same as set in the Roboteq driver (TNM parameter) -->
      <param name="motor_torque_constant">0.11</param>
      <!-- Max RPM speed set in the Roboteq driver (MXRPM parameter) -->
      <param name="max_rpm_motor_speed">3600.0</param>
      <param name="can_interface_name">robot_can</param>
      <param name="master_can_id">3</param>
      <param name="driver_can_id">1</param>
      <param name="sdo_operation_timeout_ms">100</param>
      <!-- Depends on frequency of the controller, more critical motors state are sent with
            higher frequency, other parameters are sent with lower, here allowed time is set
            to be expected period +50% margin -->
      <param name="pdo_motor_states_timeout_ms">15</param>
      <param name="pdo_driver_state_timeout_ms">75</param>
      <!-- It will be rounded to the closest value taking into account current controller frequency -->
      <param name="driver_states_update_frequency">20.0</param>
      <param name="max_roboteq_initialization_attempts">5</param>
      <param name="max_roboteq_activation_attempts">5</param>
      <!-- TODO after all tests update parameters, these ones are quite high for the worst case scenario -->
      <param name="max_write_pdo_cmds_errors_count">2</param>
      <param name="max_read_pdo_motor_states_errors_count">2</param>
      <param name="max_read_pdo_driver_state_errors_count">2</param>
    </hardware>
    <joint name="fl_wheel_joint">
      <command_interface name="velocity"/>
      <state_interface name="position"/>
      <state_interface name="velocity"/>
      <state_interface name="effort"/>
    </joint>
    <joint name="fr_wheel_joint">
      <command_interface name="velocity"/>
      <state_interface name="position"/>
      <state_interface name="velocity"/>
      <state_interface name="effort"/>
    </joint>
    <joint name="rl_wheel_joint">
      <command_interface name="velocity"/>
      <state_interface name="position"/>
      <state_interface name="velocity"/>
      <state_interface name="effort"/>
    </joint>
    <joint name="rr_wheel_joint">
      <command_interface name="velocity"/>
      <state_interface name="position"/>
      <state_interface name="velocity"/>
      <state_interface name="effort"/>
    </joint>
  </ros2_control>
  <ros2_control name="imu" type="sensor">
    <hardware>
      <plugin>husarion_ugv_hardware_interfaces/PhidgetImuSensor</plugin>
      <param name="serial">-1</param>
      <param name="hub_port">0</param>
      <param name="data_interval_ms">8</param>
      <param name="callback_delta_epsilon_ms">1</param>
      <!-- Madgwick Filter Params -->
      <param name="gain">0.00304</param>
      <param name="zeta">0.00151</param>
      <param name="mag_bias_x">0.0</param>
      <param name="mag_bias_y">0.0</param>
      <param name="mag_bias_z">0.0</param>
      <param name="use_mag">true</param>
      <param name="stateless">false</param>
      <param name="remove_gravity_vector">false</param>
      <param name="world_frame">enu</param>
    </hardware>
    <sensor name="imu">
      <state_interface name="orientation.x"/>
      <state_interface name="orientation.y"/>
      <state_interface name="orientation.z"/>
      <state_interface name="orientation.w"/>
      <state_interface name="angular_velocity.x"/>
      <state_interface name="angular_velocity.y"/>
      <state_interface name="angular_velocity.z"/>
      <state_interface name="linear_acceleration.x"/>
      <state_interface name="linear_acceleration.y"/>
      <state_interface name="linear_acceleration.z"/>
    </sensor>
  </ros2_control>
</robot>
