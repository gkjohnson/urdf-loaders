{"version":3,"file":"urdf-manipulator-element.js","sources":["../src/URDFDragControls.js","../src/urdf-manipulator-element.js"],"sourcesContent":["import { Raycaster, Vector3, Plane, Vector2 } from 'three';\n\n// Find the nearest parent that is a joint\nfunction isJoint(j) {\n\n    return j.isURDFJoint && j.jointType !== 'fixed';\n\n};\n\nfunction findNearestJoint(child) {\n\n    let curr = child;\n    while (curr) {\n\n        if (isJoint(curr)) {\n\n            return curr;\n\n        }\n\n        curr = curr.parent;\n\n    }\n\n    return curr;\n\n};\n\nconst prevHitPoint = new Vector3();\nconst newHitPoint = new Vector3();\nconst pivotPoint = new Vector3();\nconst tempVector = new Vector3();\nconst tempVector2 = new Vector3();\nconst projectedStartPoint = new Vector3();\nconst projectedEndPoint = new Vector3();\nconst plane = new Plane();\nexport class URDFDragControls {\n\n    constructor(scene) {\n\n        this.enabled = true;\n        this.scene = scene;\n        this.raycaster = new Raycaster();\n        this.initialGrabPoint = new Vector3();\n\n        this.hitDistance = -1;\n        this.hovered = null;\n        this.manipulating = null;\n\n    }\n\n    update() {\n\n        const {\n            raycaster,\n            hovered,\n            manipulating,\n            scene,\n        } = this;\n\n        if (manipulating) {\n\n            return;\n\n        }\n\n        let hoveredJoint = null;\n        const intersections = raycaster.intersectObject(scene, true);\n        if (intersections.length !== 0) {\n\n            const hit = intersections[0];\n            this.hitDistance = hit.distance;\n            hoveredJoint = findNearestJoint(hit.object);\n            this.initialGrabPoint.copy(hit.point);\n\n        }\n\n        if (hoveredJoint !== hovered) {\n\n            if (hovered) {\n\n                this.onUnhover(hovered);\n\n            }\n\n            this.hovered = hoveredJoint;\n\n            if (hoveredJoint) {\n\n                this.onHover(hoveredJoint);\n\n            }\n\n        }\n\n    }\n\n    updateJoint(joint, angle) {\n\n        joint.setJointValue(angle);\n\n    }\n\n    onDragStart(joint) {\n\n    }\n\n    onDragEnd(joint) {\n\n    }\n\n    onHover(joint) {\n\n    }\n\n    onUnhover(joint) {\n\n    }\n\n    getRevoluteDelta(joint, startPoint, endPoint) {\n\n        // set up the plane\n        tempVector\n            .copy(joint.axis)\n            .transformDirection(joint.matrixWorld)\n            .normalize();\n        pivotPoint\n            .set(0, 0, 0)\n            .applyMatrix4(joint.matrixWorld);\n        plane\n            .setFromNormalAndCoplanarPoint(tempVector, pivotPoint);\n\n        // project the drag points onto the plane\n        plane.projectPoint(startPoint, projectedStartPoint);\n        plane.projectPoint(endPoint, projectedEndPoint);\n\n        // get the directions relative to the pivot\n        projectedStartPoint.sub(pivotPoint);\n        projectedEndPoint.sub(pivotPoint);\n\n        tempVector.crossVectors(projectedStartPoint, projectedEndPoint);\n\n        const direction = Math.sign(tempVector.dot(plane.normal));\n        return direction * projectedEndPoint.angleTo(projectedStartPoint);\n\n    }\n\n    getPrismaticDelta(joint, startPoint, endPoint) {\n\n        tempVector.subVectors(endPoint, startPoint);\n        plane\n            .normal\n            .copy(joint.axis)\n            .transformDirection(joint.parent.matrixWorld)\n            .normalize();\n\n        return tempVector.dot(plane.normal);\n\n    }\n\n    moveRay(toRay) {\n\n        const { raycaster, hitDistance, manipulating } = this;\n        const { ray } = raycaster;\n\n        if (manipulating) {\n\n            ray.at(hitDistance, prevHitPoint);\n            toRay.at(hitDistance, newHitPoint);\n\n            let delta = 0;\n            if (manipulating.jointType === 'revolute' || manipulating.jointType === 'continuous') {\n\n                delta = this.getRevoluteDelta(manipulating, prevHitPoint, newHitPoint);\n\n            } else if (manipulating.jointType === 'prismatic') {\n\n                delta = this.getPrismaticDelta(manipulating, prevHitPoint, newHitPoint);\n\n            }\n\n            if (delta) {\n\n                this.updateJoint(manipulating, manipulating.angle + delta);\n\n            }\n\n        }\n\n        this.raycaster.ray.copy(toRay);\n        this.update();\n\n    }\n\n    setGrabbed(grabbed) {\n\n        const { hovered, manipulating } = this;\n\n        if (grabbed) {\n\n            if (manipulating !== null || hovered === null) {\n\n                return;\n\n            }\n\n            this.manipulating = hovered;\n            this.onDragStart(hovered);\n\n        } else {\n\n            if (this.manipulating === null) {\n                return;\n            }\n\n            this.onDragEnd(this.manipulating);\n            this.manipulating = null;\n            this.update();\n\n        }\n\n    }\n\n}\n\nexport class PointerURDFDragControls extends URDFDragControls {\n\n    constructor(scene, camera, domElement) {\n\n        super(scene);\n        this.camera = camera;\n        this.domElement = domElement;\n\n        const raycaster = new Raycaster();\n        const mouse = new Vector2();\n\n        function updateMouse(e) {\n\n            mouse.x = ((e.pageX - domElement.offsetLeft) / domElement.offsetWidth) * 2 - 1;\n            mouse.y = -((e.pageY - domElement.offsetTop) / domElement.offsetHeight) * 2 + 1;\n\n        }\n\n        this._mouseDown = e => {\n\n            updateMouse(e);\n            raycaster.setFromCamera(mouse, this.camera);\n            this.moveRay(raycaster.ray);\n            this.setGrabbed(true);\n\n        };\n\n        this._mouseMove = e => {\n\n            updateMouse(e);\n            raycaster.setFromCamera(mouse, this.camera);\n            this.moveRay(raycaster.ray);\n\n        };\n\n        this._mouseUp = e => {\n\n            updateMouse(e);\n            raycaster.setFromCamera(mouse, this.camera);\n            this.moveRay(raycaster.ray);\n            this.setGrabbed(false);\n\n        };\n\n        domElement.addEventListener('mousedown', this._mouseDown);\n        domElement.addEventListener('mousemove', this._mouseMove);\n        domElement.addEventListener('mouseup', this._mouseUp);\n\n    }\n\n    getRevoluteDelta(joint, startPoint, endPoint) {\n\n        const { camera, initialGrabPoint } = this;\n\n        // set up the plane\n        tempVector\n            .copy(joint.axis)\n            .transformDirection(joint.matrixWorld)\n            .normalize();\n        pivotPoint\n            .set(0, 0, 0)\n            .applyMatrix4(joint.matrixWorld);\n        plane\n            .setFromNormalAndCoplanarPoint(tempVector, pivotPoint);\n\n        tempVector\n            .copy(camera.position)\n            .sub(initialGrabPoint)\n            .normalize();\n\n        // if looking into the plane of rotation\n        if (Math.abs(tempVector.dot(plane.normal)) > 0.3) {\n\n            return super.getRevoluteDelta(joint, startPoint, endPoint);\n\n        } else {\n\n            // get the up direction\n            tempVector.set(0, 1, 0).transformDirection(camera.matrixWorld);\n\n            // get points projected onto the plane of rotation\n            plane.projectPoint(startPoint, projectedStartPoint);\n            plane.projectPoint(endPoint, projectedEndPoint);\n\n            tempVector.set(0, 0, -1).transformDirection(camera.matrixWorld);\n            tempVector.cross(plane.normal);\n            tempVector2.subVectors(endPoint, startPoint);\n\n            return tempVector.dot(tempVector2);\n\n        }\n\n    }\n\n    dispose() {\n\n        const { domElement } = this;\n        domElement.removeEventListener('mousedown', this._mouseDown);\n        domElement.removeEventListener('mousemove', this._mouseMove);\n        domElement.removeEventListener('mouseup', this._mouseUp);\n\n    }\n\n}\n","import * as THREE from 'three';\nimport URDFViewer from './urdf-viewer-element.js';\nimport { PointerURDFDragControls } from './URDFDragControls.js';\n\n// urdf-manipulator element\n// Displays a URDF model that can be manipulated with the mouse\n\n// Events\n// joint-mouseover: Fired when a joint is hovered over\n// joint-mouseout: Fired when a joint is no longer hovered over\n// manipulate-start: Fires when a joint is manipulated\n// manipulate-end: Fires when a joint is done being manipulated\nexport default\nclass URDFManipulator extends URDFViewer {\n\n    static get observedAttributes() {\n\n        return ['highlight-color', ...super.observedAttributes];\n\n    }\n\n    get disableDragging() { return this.hasAttribute('disable-dragging'); }\n    set disableDragging(val) { val ? this.setAttribute('disable-dragging', !!val) : this.removeAttribute('disable-dragging'); }\n\n    get highlightColor() { return this.getAttribute('highlight-color') || '#FFFFFF'; }\n    set highlightColor(val) { val ? this.setAttribute('highlight-color', val) : this.removeAttribute('highlight-color'); }\n\n    constructor(...args) {\n\n        super(...args);\n\n        // The highlight material\n        this.highlightMaterial =\n            new THREE.MeshPhongMaterial({\n                shininess: 10,\n                color: this.highlightColor,\n                emissive: this.highlightColor,\n                emissiveIntensity: 0.25,\n            });\n\n        const isJoint = j => {\n\n            return j.isURDFJoint && j.jointType !== 'fixed';\n\n        };\n\n        // Highlight the link geometry under a joint\n        const highlightLinkGeometry = (m, revert) => {\n\n            const traverse = c => {\n\n                // Set or revert the highlight color\n                if (c.type === 'Mesh') {\n\n                    if (revert) {\n\n                        c.material = c.__origMaterial;\n                        delete c.__origMaterial;\n\n                    } else {\n\n                        c.__origMaterial = c.material;\n                        c.material = this.highlightMaterial;\n\n                    }\n\n                }\n\n                // Look into the children and stop if the next child is\n                // another joint\n                if (c === m || !isJoint(c)) {\n\n                    for (let i = 0; i < c.children.length; i++) {\n\n                        const child = c.children[i];\n                        if (!child.isURDFCollider) {\n\n                            traverse(c.children[i]);\n\n                        }\n\n                    }\n\n                }\n\n            };\n\n            traverse(m);\n\n        };\n\n        const el = this.renderer.domElement;\n\n        const dragControls = new PointerURDFDragControls(this.scene, this.camera, el);\n        dragControls.onDragStart = joint => {\n\n            this.dispatchEvent(new CustomEvent('manipulate-start', { bubbles: true, cancelable: true, detail: joint.name }));\n            this.controls.enabled = false;\n            this.redraw();\n\n        };\n        dragControls.onDragEnd = joint => {\n\n            this.dispatchEvent(new CustomEvent('manipulate-end', { bubbles: true, cancelable: true, detail: joint.name }));\n            this.controls.enabled = true;\n            this.redraw();\n\n        };\n        dragControls.updateJoint = (joint, angle) => {\n\n            this.setJointValue(joint.name, angle);\n\n        };\n        dragControls.onHover = joint => {\n\n            highlightLinkGeometry(joint, false);\n            this.dispatchEvent(new CustomEvent('joint-mouseover', { bubbles: true, cancelable: true, detail: joint.name }));\n            this.redraw();\n\n        };\n        dragControls.onUnhover = joint => {\n\n            highlightLinkGeometry(joint, true);\n            this.dispatchEvent(new CustomEvent('joint-mouseout', { bubbles: true, cancelable: true, detail: joint.name }));\n            this.redraw();\n\n        };\n\n        this.dragControls = dragControls;\n\n    }\n\n    disconnectedCallback() {\n\n        super.disconnectedCallback();\n        this.dragControls.dispose();\n\n    }\n\n    attributeChangedCallback(attr, oldval, newval) {\n\n        super.attributeChangedCallback(attr, oldval, newval);\n\n        switch (attr) {\n\n            case 'highlight-color':\n                this.highlightMaterial.color.set(this.highlightColor);\n                this.highlightMaterial.emissive.set(this.highlightColor);\n                break;\n\n        }\n\n    }\n\n};\n"],"names":["Vector3","Plane","Raycaster","Vector2","URDFViewer","THREE"],"mappings":"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"}